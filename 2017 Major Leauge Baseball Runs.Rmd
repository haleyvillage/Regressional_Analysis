---
title: "2017 Major Leauge Baseball Runs"
author: "Haley Lorenz"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library("plyr")
```

```{r}
mlb <- read.csv("MLBRUNS2017.csv")
```

```{r}
summary(mlb)
```

Finding the regression coefficients
```{r}
beta = lm(RUNS ~ WALKS + SINGLES + DOUBLES + TRIPLES + HOMERUNS + STOLEBASES + CAUGHTSTEAL + STRIKEOUTS, data = mlb)
```


Coefficients and significance
```{r}
summary(beta)
```

```{r}
confint(beta,parm='STOLEBASES', level = 0.95)
```
This means there is a 95% chance that the true mean is between (-.382, 1.772) 

The least squares prediction equation is the following
```{r}
coefficients <- coef(beta)
paste("RUNS = ", round(coefficients[1], 4), " + ", 
      round(coefficients['WALKS'], 4), "*WALKS + ", 
      round(coefficients['SINGLES'], 4), "*SINGLES + ", 
      round(coefficients['DOUBLES'], 4), "*DOUBLES + ", 
      round(coefficients['TRIPLES'], 4), "*TRIPLES + ", 
      round(coefficients['HOMERUNS'], 4), "*HOMERUNS + ", 
      round(coefficients['STOLENBASES'], 4), "*STOLENBASES + ", 
      round(coefficients['CAUGHTSTEAL'], 4), "*CAUGHTSTEAL + ", 
      round(coefficients['STRIKEOUTS'], 4), "*STRIKEOUTS", 
      sep = "")

```

The practical interpretations of the beta estimates are the following
```{r}
output_text <- sapply(names(coefficients), function(var_name) {
  coef_value <- round(coefficients[var_name], 4)
  paste(coef_value, ": For every", var_name, "earned (", var_name, "increase by 1) the avg number of runs increases by", coef_value)
}, USE.NAMES = FALSE)

cat(output_text, sep = "\n")
```

```{r}
triples_confint <- confint(beta, "TRIPLES", level = 0.95)
print(triples_confint)
```
This means there is a 95% chance that the true mean is between (-.382, 1.772) 

```{r}
predict(beta,data.frame(HITS =1477, DOUBLES=311, TRIPLES=31, HOMERUNS=215, WALKS=542, STRIKEOUTS=1327, STOLEBASES=108, CAUGHTSTEAL=30, GRNDOUTS=1.09, SINGLES=920), interval="prediction")
```
I inputted the Washington Nationals stats and the program predicted they will score between 771.66 and 866.19 runs. From our CSV they scored 819 meaning we have an accurate model/prediction.